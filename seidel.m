function [x, k, err_hist] = seidel(A, b, x0, tol, max_iter)
% GAUSS_SEIDEL –†–µ—à–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É Ax=b –º–µ—Ç–æ–¥–æ–º –ó–µ–π–¥–µ–ª—è.
%   –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
%   A          - –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ N x N
%   b          - –í–µ–∫—Ç–æ—Ä –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ N x 1
%   x0         - –ù–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ (N x 1)
%   tol        - –î–æ–ø—É—Å–∫ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞)
%   max_iter   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π
%
%   –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
%   x          - –ù–∞–π–¥–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
%   k          - –ß–∏—Å–ª–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π
%   err_hist   - –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –æ—à–∏–±–∫–∏

N = length(b);
x = x0(:); % –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ x - —Å—Ç–æ–ª–±–µ—Ü
err_hist = [];

% –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (a_ii != 0)
if any(diag(A) == 0)
  error('–û—à–∏–±–∫–∞, –ú–∞—Å—Ç–µ—Ä: –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Ä–∞–≤–µ–Ω –Ω—É–ª—é. –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.');
end

for k = 1:max_iter
  x_old = x; % –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–µ–∫—Ç–æ—Ä –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
  
  % –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ü–∏–∫–ª –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
  for i = 1:N
    sigma = 0;
    
    % –†–∞—Å—á–µ—Ç —Å—É–º–º—ã
    for j = 1:N
      if i ~= j
        % –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∞–º–æ–µ —Å–≤–µ–∂–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ x(j):
        % –ï—Å–ª–∏ j < i, —ç—Ç–æ —É–∂–µ x^(k+1); –µ—Å–ª–∏ j > i, —ç—Ç–æ x^(k).
        sigma = sigma + A(i, j) * x(j);
      end
    end
    
    % –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ i-–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    x(i) = (b(i) - sigma) / A(i, i);
  end
  
  % üî¨ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞)
  error_current = norm(x - x_old, inf) / norm(x, inf);
  err_hist(k) = error_current;
  
  if error_current < tol
    break;
  end
end

if k == max_iter && error_current >= tol
  warning('–í–Ω–∏–º–∞–Ω–∏–µ: –ú–µ—Ç–æ–¥ –Ω–µ —Å–æ—à–µ–ª—Å—è –∑–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π.');
end
end
